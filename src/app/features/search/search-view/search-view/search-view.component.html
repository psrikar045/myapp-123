<!-- Enhanced Search View Component with Dark/Light Theme Support -->
<div class="container pad100" [attr.data-theme]="isDarkMode ? 'dark' : 'light'">
  <div class="container card card-bg py-4 mt-4 mb-4">
    
    <!-- Error/No Data Message -->
    <div *ngIf="!searchResult" class="row">
      <div class="col-12">
        <div class="alert alert-warning text-center">
          <h3><i class="bi bi-exclamation-triangle me-2"></i>No Brand Data Available</h3>
          <p>Sorry, we couldn't find the brand information you're looking for.</p>
          <button class="btn btn-primary" (click)="goBackToSearch()">
            <i class="bi bi-arrow-left me-2"></i>Go Back
          </button>
        </div>
      </div>
    </div>
    
    <!-- Main Content - Only show when searchResult exists -->
    <div *ngIf="searchResult">
      <!-- Back Navigation -->
      <div class="row mb-4">
        <div class="col-12">
          <button class="back-arrow-btn" (click)="goBackToSearch()" aria-label="Back to Search">
            <svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 5l-5 5 5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            Back
          </button>
        </div>
      </div>

      <!-- Company Banner Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="company-banner-wrapper">
            <div class="company-banner">
              <img class="banner-bg-img" 
                   [src]="searchResult?.Logo?.Banner || 'assets/images/banner-placeholder.webp'" 
                   alt="Company Banner"
                   (error)="onImageError($event)">
              <div class="banner-overlay"></div>
            </div>
            <div class="banner-logo-circle">
              <ng-container *ngIf="searchResult?.Logo?.Logo; else defaultBannerLogo">
                <img class="banner-logo" 
                     [src]="searchResult.Logo.Logo" 
                     [alt]="searchResult?.Company?.Name + ' Logo'"
                     (error)="onImageError($event)">
              </ng-container>
              <ng-template #defaultBannerLogo>
                <div class="default-banner-logo">
                  {{ (searchResult?.Company?.Name || 'B').charAt(0).toUpperCase() }}
                </div>
              </ng-template>
            </div>
          </div>
        </div>
      </div>

      <!-- Brand Info Section -->
      <div class="row mb-4" *ngIf="searchResult?.Company">
        <div class="col-12">
          <div class="brand-info-row">
            <div class="brand-info-main">
              <div class="brand-title-row">
                <h1 class="brand-title">{{ searchResult?.Company?.Name }}</h1>
                <!-- <span class="claimed-badge">
                  <i class="bi bi-patch-check-fill"></i>
                  Claimed Brand
                </span> -->
              </div>
            </div>
            <div class="brand-info-actions">
              <!-- <button class="share-btn">
                <i class="bi bi-share"></i>
                Share
              </button> -->
              <div class="company-socials">
                <ng-container *ngFor="let social of getCombinedSocialLinks()">
                  <ng-container *ngIf="getSocialIconClass(social.platform)">
                    <a [href]="social.url" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       [attr.aria-label]="getSocialAriaLabel(social.platform)">
                      <i [class]="getSocialIconClass(social.platform)"></i>
                    </a>
                  </ng-container>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Brand Description Section -->
      <div class="row mb-4" *ngIf="searchResult?.Company?.Description">
        <div class="col-12">
          <div class="brand-description">
            <ng-container *ngIf="!showFullDescription">
              <span>{{ getFirstNLines(searchResult?.Company?.Description, 3) }}</span>
              <ng-container *ngIf="shouldShowViewMore">
                <span class="view-more-btn-inline"
                      [class.disabled]="!isAuthenticated"
                      [attr.aria-disabled]="!isAuthenticated"
                      (click)="onViewMoreClick()">
                  View more
                </span>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="showFullDescription">
              <span>{{ searchResult?.Company?.Description }}</span>
              <ng-container *ngIf="shouldShowViewMore">
                <span class="view-more-btn-inline"
                      [class.disabled]="!isAuthenticated"
                      [attr.aria-disabled]="!isAuthenticated"
                      (click)="onViewMoreClick()">
                  View less
                </span>
              </ng-container>
            </ng-container>
          </div>
        </div>
      </div>
      <!-- Filter Buttons -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="company-filters" [ngClass]="{'no-brand-margin': !searchResult?.Company}">
            <button *ngFor="let filter of filters" 
                    class="filter-btn" 
                    [class.active]="activeFilter === filter" 
                    [attr.data-active]="activeFilter === filter"
                    [attr.data-filter]="filter"
                    [attr.data-current-active]="activeFilter"
                    (click)="setFilter(filter)">
              {{ filter }}
              <span *ngIf="activeFilter === filter" style="margin-left: 4px;">âœ“</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Logos Section -->
      <section class="company-section" *ngIf="showSection('Logos')">
        <h3>Logos</h3>
        <div class="company-logos">
          <ng-container *ngFor="let logoEntry of getLogoEntries(searchResult?.Logo)">
            <div class="logo-card" 
                 *ngIf="isValidImageUrl(logoEntry.value)"
                 [ngClass]="{'banner-logo': logoEntry.key.toLowerCase() === 'banner'}">
              <img [src]="logoEntry.value" 
                   [alt]="generateAltText(searchResult?.Company?.Name, logoEntry.key)"
                   (error)="onImageError($event)">
              <div class="logo-labels">
                <span>{{ generateLogoLabel(logoEntry.key) }}</span>
                <span *ngIf="logoEntry.key !== generateLogoLabel(logoEntry.key)">({{ logoEntry.key }})</span>
              </div>
            </div>
          </ng-container>
      
          <ng-container *ngIf="!hasDisplayableLogos(searchResult?.Logo)">
            <div class="no-content-message">
              <i class="bi bi-image display-1 mb-3"></i>
              <h4>No displayable logos found</h4>
              <p>Brand logos will appear here when available</p>
            </div>
          </ng-container>
        </div>
      </section>

      <!-- Color Section -->
      <section class="company-section" *ngIf="showSection('Colors')">
        <h3>Color</h3>
        <div class="company-section-desc">
          Color is the cornerstone of brand design. It distinguishes the brand and helps create consistent
          experiences across marketing and products. We use color in meaningful ways in all expressions of our brand.
        </div>
        <div class="company-color-palette">
          <ng-container *ngIf="hasDisplayableColors(searchResult?.Colors)">
            <div class="color-swatch" 
                 *ngFor="let colorItem of searchResult.Colors" 
                 [ngClass]="{'banner-color': (colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('banner')) || (colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('logo'))}"
                 [style.background]="(colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('banner')) || (colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('logo')) ? '#ffffff' : colorItem.hex"
                 [style.color]="(colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('banner')) || (colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('logo')) ? '#000000' : (colorItem.hex && (colorItem.hex.toLowerCase() === '#ffffff' || colorItem.hex.toLowerCase() === '#fff') ? '#222' : '#fff')">
              <span *ngIf="colorItem.hex">{{ colorItem.hex }}</span>
              <span *ngIf="colorItem.name && colorItem.name !== ''"
                    [style.color]="(colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('banner')) || (colorItem.usageContext && colorItem.usageContext.toLowerCase().includes('logo')) ? '#000000' : (colorItem.brightness > 186 ? '#000' : '#fff')">
                {{ colorItem.name }}
              </span>
            </div>
          </ng-container>
      
          <ng-container *ngIf="!hasDisplayableColors(searchResult?.Colors)">
            <div class="no-content-message">
              <i class="bi bi-palette display-1 mb-3"></i>
              <h4>No brand colors found</h4>
              <p>Brand color palette will appear here when available</p>
            </div>
          </ng-container>
        </div>
      </section>

      <!-- Font Section -->
      <section class="company-section" *ngIf="showSection('Font')">
        <div class="company-fonts-display">
          <h3>Fonts</h3>
          <ng-container *ngIf="hasDisplayableFonts(searchResult?.Fonts)">
            <div class="font-preview-card" *ngFor="let fontItem of searchResult.Fonts">
              <ng-container *ngIf="fontItem.family || fontItem.name">
                <div class="font-name" [style.font-family]="getFontDisplayName(fontItem)">
                  {{ getFontDisplayName(fontItem) }}
                </div>
                <div class="font-sample-text" [style.font-family]="getFontDisplayName(fontItem)">
                  The quick brown fox jumps over the lazy dog.
                  <span *ngIf="getFontDetailsText(fontItem)" class="font-details">
                    {{ getFontDetailsText(fontItem) }}
                  </span>
                </div>
              </ng-container>
            </div>
          </ng-container>
      
          <ng-container *ngIf="!hasDisplayableFonts(searchResult?.Fonts)">
            <div class="no-content-message">
              <i class="bi bi-fonts display-1 mb-3"></i>
              <h4>No brand fonts found</h4>
              <p>Brand typography will appear here when available</p>
            </div>
          </ng-container>
        </div>
      </section>

      <!-- Images Section -->
      <section class="company-section" *ngIf="showSection('Images')">
        <h3>Images</h3>
        <div class="company-images-gallery">
          <ng-container *ngIf="hasDisplayableImages(searchResult?.Images)">
            <div class="image-card" *ngFor="let imageItem of searchResult.Images">
              <ng-container *ngIf="isValidImageUrl(getImageSource(imageItem))">
                <img [src]="getImageSource(imageItem)"
                     [alt]="getImageAltText(searchResult?.Company?.Name, imageItem)"
                     (error)="onImageError($event)">
              </ng-container>
            </div>
          </ng-container>

          <ng-container *ngIf="!hasDisplayableImages(searchResult?.Images)">
            <div class="no-content-message">
              <i class="bi bi-images display-1 mb-3"></i>
              <h4>No brand images found</h4>
              <p>Brand images will appear here when available</p>
            </div>
          </ng-container>
        </div>
      </section>
      
    </div> <!-- End of searchResult conditional -->
    
  </div>
</div>

<app-footer></app-footer>
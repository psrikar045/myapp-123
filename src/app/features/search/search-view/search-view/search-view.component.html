<app-header></app-header>

<!-- Bootstrap Responsive Search View -->
<div class="search-view-container bg-light min-vh-100">
  <div class="container-fluid py-4">
    
    <!-- Error/No Data Message -->
    <div *ngIf="!searchResult" class="row">
      <div class="col-12">
        <div class="alert alert-warning text-center">
          <h4><i class="bi bi-exclamation-triangle me-2"></i>No Brand Data Available</h4>
          <p>Sorry, we couldn't find the brand information you're looking for.</p>
          <button class="btn btn-primary" (click)="goBackToSearch()">
            <i class="bi bi-arrow-left me-2"></i>Go Back
          </button>
        </div>
      </div>
    </div>
    
    <!-- Main Content - Only show when searchResult exists -->
    <div *ngIf="searchResult">
      <!-- Back Navigation -->
      <div class="row mb-3">
        <div class="col-12">
          <button class="btn btn-link text-primary p-0" 
                  (click)="goBackToSearch()" 
                  aria-label="Back to Search">
            <i class="bi bi-arrow-left me-2"></i>
            Back to Search
          </button>
        </div>
      </div>
    <!-- Company Banner Section -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="company-banner-card card border-0 shadow-sm overflow-hidden">
          <div class="banner-wrapper position-relative">
            <img class="banner-image w-100" 
                 [src]="searchResult?.Logo?.Banner || 'assets/images/banner-placeholder.png'" 
                 alt="Company Banner"
                 style="height: 200px; object-fit: cover;">
            <div class="banner-overlay position-absolute top-0 start-0 w-100 h-100" 
                 style="background: linear-gradient(45deg, rgba(0,0,0,0.3), rgba(0,0,0,0.1));"></div>
            
            <!-- Company Logo -->
            <div class="company-logo-wrapper position-absolute" 
                 style="bottom: -30px; left: 2rem;">
              <div class="logo-circle bg-white rounded-circle p-2 shadow-sm d-flex align-items-center justify-content-center"
                   style="width: 80px; height: 80px;">
                <ng-container *ngIf="searchResult?.Logo?.Logo; else defaultLogo">
                  <img class="company-logo" 
                       [src]="searchResult.Logo.Logo" 
                       [alt]="searchResult?.Company?.Name + ' Logo'"
                       style="max-width: 60px; max-height: 60px; object-fit: contain;"
                       (error)="onImageError($event)">
                </ng-container>
                <ng-template #defaultLogo>
                  <div class="default-logo d-flex align-items-center justify-content-center"
                       style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; color: white; font-size: 24px; font-weight: bold;">
                    {{ (searchResult?.Company?.Name || 'B').charAt(0).toUpperCase() }}
                  </div>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Brand Info Section -->
    <div class="row mb-4" *ngIf="searchResult?.Company">
      <div class="col-12">
        <div class="brand-info-card card border-0 shadow-sm">
          <div class="card-body p-4" style="padding-top: 3rem !important;">
            <div class="row align-items-center">
              <div class="col-lg-8 col-md-7 col-12">
                <div class="brand-header">
                  <h1 class="brand-name display-6 fw-bold mb-2">{{ searchResult?.Company?.Name }}</h1>
                  <!-- <span class="badge bg-success">
                    <i class="bi bi-patch-check-fill me-1"></i>
                    Verified Brand
                  </span> -->
                </div>
              </div>
              
              <div class="col-lg-4 col-md-5 col-12 text-center text-md-end mt-3 mt-md-0">
                <div class="social-links d-flex justify-content-center justify-content-md-end gap-2 flex-wrap">
                  <ng-container *ngFor="let social of getCombinedSocialLinks()">
                    <ng-container *ngIf="getSocialIconClass(social.platform)">
                      <a [href]="social.url" 
                         target="_blank" 
                         rel="noopener noreferrer"
                         [attr.aria-label]="getSocialAriaLabel(social.platform)"
                         class="btn btn-outline-primary btn-sm rounded-circle d-flex align-items-center justify-content-center"
                         style="width: 40px; height: 40px;">
                        <i [class]="getSocialIconClass(social.platform)"></i>
                      </a>
                    </ng-container>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Brand Description Section -->
    <div class="row mb-4" *ngIf="searchResult?.Company?.Description">
      <div class="col-12">
        <div class="description-card card border-0 shadow-sm">
          <div class="card-body p-4">
            <h5 class="card-title fw-bold mb-3">About {{ searchResult?.Company?.Name }}</h5>
            <div class="description-content">
              <p class="card-text" *ngIf="!showFullDescription">
                {{ getFirstNLines(searchResult?.Company?.Description, 3) }}
                <button *ngIf="shouldShowViewMore" 
                        class="btn btn-link p-0 ms-2 text-primary"
                        [class.disabled]="!isAuthenticated"
                        [attr.aria-disabled]="!isAuthenticated"
                        (click)="onViewMoreClick()">
                  View more
                </button>
              </p>
              <p class="card-text" *ngIf="showFullDescription">
                {{ searchResult?.Company?.Description }}
                <button *ngIf="shouldShowViewMore" 
                        class="btn btn-link p-0 ms-2 text-primary"
                        [class.disabled]="!isAuthenticated"
                        [attr.aria-disabled]="!isAuthenticated"
                        (click)="onViewMoreClick()">
                  View less
                </button>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Buttons -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="filter-card card border-0 shadow-sm">
          <div class="card-body p-3">
            <div class="d-flex flex-wrap gap-2 justify-content-center justify-content-md-start">
              <button *ngFor="let filter of filters" 
                      class="btn btn-outline-primary"
                      [class.active]="activeFilter === filter"
                      (click)="setFilter(filter)">
                {{ filter }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Logos Section -->
    <div class="row mb-4" *ngIf="showSection('Logos')">
      <div class="col-12">
        <div class="logos-section-card card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom-0 py-3">
            <h3 class="card-title fw-bold mb-0">Brand Logos</h3>
          </div>
          <div class="card-body p-4">
            <div class="row g-4" *ngIf="hasDisplayableLogos(searchResult?.Logo); else noLogos">
              <div class="col-lg-3 col-md-4 col-sm-6 col-12" 
                   *ngFor="let logoEntry of getLogoEntries(searchResult?.Logo)">
                <div class="logo-item card border h-100" *ngIf="isValidImageUrl(logoEntry.value)">
                  <div class="card-body p-3 text-center">
                    <div class="logo-image-wrapper mb-3">
                      <img [src]="logoEntry.value" 
                           [alt]="generateAltText(searchResult?.Company?.Name, logoEntry.key)"
                           class="img-fluid"
                           style="max-height: 80px; object-fit: contain;">
                    </div>
                    <div class="logo-info">
                      <h6 class="fw-semibold mb-1">{{ generateLogoLabel(logoEntry.key) }}</h6>
                      <small class="text-muted" *ngIf="logoEntry.key !== generateLogoLabel(logoEntry.key)">
                        ({{ logoEntry.key }})
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <ng-template #noLogos>
              <div class="text-center py-5">
                <i class="bi bi-image display-1 text-muted mb-3"></i>
                <h5 class="text-muted">No displayable logos found</h5>
                <p class="text-muted">Brand logos will appear here when available</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>

    <!-- Colors Section -->
    <div class="row mb-4" *ngIf="showSection('Colors')">
      <div class="col-12">
        <div class="colors-section-card card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom-0 py-3">
            <h3 class="card-title fw-bold mb-0">Brand Colors</h3>
          </div>
          <div class="card-body p-4">
            <p class="text-muted mb-4">
              Color is the cornerstone of brand design. It distinguishes the brand and helps create consistent
              experiences across marketing and products.
            </p>
            
            <div class="row g-3" *ngIf="hasDisplayableColors(searchResult?.Colors); else noColors">
              <div class="col-lg-2 col-md-3 col-sm-4 col-6" 
                   *ngFor="let colorItem of searchResult.Colors">
                <div class="color-swatch-card card border h-100">
                  <div class="color-preview" 
                       [style.background]="colorItem.hex"
                       style="height: 80px; border-radius: 0.375rem 0.375rem 0 0;">
                  </div>
                  <div class="card-body p-2 text-center">
                    <small class="fw-bold d-block" *ngIf="colorItem.hex">
                      {{ colorItem.hex }}
                    </small>
                    <small class="text-muted" *ngIf="colorItem.name && colorItem.name !== ''">
                      {{ colorItem.name }}
                    </small>
                  </div>
                </div>
              </div>
            </div>
            
            <ng-template #noColors>
              <div class="text-center py-5">
                <i class="bi bi-palette display-1 text-muted mb-3"></i>
                <h5 class="text-muted">No brand colors found</h5>
                <p class="text-muted">Brand color palette will appear here when available</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  
      <ng-container *ngIf="!hasDisplayableColors(searchResult?.Colors)">
        <p class="no-colors-message">No color palette available.</p>
      </ng-container>
    </div>

    <!-- Fonts Section -->
    <div class="row mb-4" *ngIf="showSection('Font')">
      <div class="col-12">
        <div class="fonts-section-card card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom-0 py-3">
            <h3 class="card-title fw-bold mb-0">Brand Fonts</h3>
          </div>
          <div class="card-body p-4">
            <div class="row g-3" *ngIf="hasDisplayableFonts(searchResult?.Fonts); else noFonts">
              <div class="col-lg-6 col-12" *ngFor="let fontItem of searchResult.Fonts">
                <div class="font-preview-card card border h-100" *ngIf="fontItem.family || fontItem.name">
                  <div class="card-body p-3">
                    <h6 class="font-name fw-bold mb-2" [style.font-family]="getFontDisplayName(fontItem)">
                      {{ getFontDisplayName(fontItem) }}
                    </h6>
                    <p class="font-sample-text mb-0" [style.font-family]="getFontDisplayName(fontItem)">
                      The quick brown fox jumps over the lazy dog.
                    </p>
                    <small class="text-muted" *ngIf="getFontDetailsText(fontItem)">
                      {{ getFontDetailsText(fontItem) }}
                    </small>
                  </div>
                </div>
              </div>
            </div>
            
            <ng-template #noFonts>
              <div class="text-center py-5">
                <i class="bi bi-fonts display-1 text-muted mb-3"></i>
                <h5 class="text-muted">No brand fonts found</h5>
                <p class="text-muted">Brand typography will appear here when available</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>

    <!-- Images Section -->
    <div class="row mb-4" *ngIf="showSection('Images')">
      <div class="col-12">
        <div class="images-section-card card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom-0 py-3">
            <h3 class="card-title fw-bold mb-0">Brand Images</h3>
          </div>
          <div class="card-body p-4">
            <div class="row g-4" *ngIf="hasDisplayableImages(searchResult?.Images); else noImages">
              <div class="col-lg-4 col-md-6 col-12" *ngFor="let imageItem of searchResult.Images">
                <div class="image-item card border h-100" *ngIf="isValidImageUrl(getImageSource(imageItem))">
                  <div class="image-wrapper">
                    <img [src]="getImageSource(imageItem)" 
                         [alt]="getImageAltText(searchResult?.Company?.Name, imageItem)"
                         class="card-img-top"
                         style="height: 200px; object-fit: cover;">
                  </div>
                  <div class="card-body p-3">
                    <h6 class="fw-semibold mb-1">Brand Image</h6>
                    <small class="text-muted">Additional brand imagery</small>
                  </div>
                </div>
              </div>
            </div>
            
            <ng-template #noImages>
              <div class="text-center py-5">
                <i class="bi bi-images display-1 text-muted mb-3"></i>
                <h5 class="text-muted">No brand images found</h5>
                <p class="text-muted">Brand images will appear here when available</p>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    
    </div> <!-- End of searchResult conditional -->
    
  </div>

<app-footer></app-footer>

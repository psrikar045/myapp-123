<div class="verify-code-page-wrapper" [class.dark-theme]="isDarkMode">
  <div class="verify-code-container" mat-typography>
    <div class="verify-code-left">
      <div class="navigation-header">
        <a (click)="back()" class="back-link" i18n="@@backLink">
          <mat-icon>arrow_back</mat-icon> Back
        </a>
      </div>
      <img src="images/logo.svg" alt="TravelWise Logo" class="logo" i18n-alt="@@logoAltText">
      <div class="panel-spacer-top"></div>
      <div class="verify-code-panel">
        <h2 i18n="@@verifyCodeTitle">Verify code</h2>
        <p class="subtitle" i18n="@@verifyCodeSubtitle">An authentication code has been sent to your email.</p>

        <div *ngIf="errorMessage" class="error-message" role="alert">
          {{ errorMessage }}
        </div>

        <form [formGroup]="verifyCodeForm" (ngSubmit)="onSubmit()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label i18n="@@verificationCodeLabel">Verification Code</mat-label>
            <input matInput [type]="hideCode ? 'password' : 'text'" formControlName="code" placeholder="Enter 6-digit code" i18n-placeholder="@@codePlaceholder" required autofocus>
            <button mat-icon-button matSuffix (click)="toggleCodeVisibility()" type="button" [attr.aria-label]="hideCode ? 'Show code' : 'Hide code'" [attr.i18n-aria-label]="hideCode ? '@@showCodeAriaLabel' : '@@hideCodeAriaLabel'">
              <mat-icon>{{hideCode ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="code.hasError('required')" i18n="@@codeRequiredError">
              Verification code is required.
            </mat-error>
            <mat-error *ngIf="(code.hasError('minlength') || code.hasError('maxlength')) && !code.hasError('required')" i18n="@@codeLengthError">
              Code must be 6 characters long.
            </mat-error>
          </mat-form-field>

          <div class="code-options">
            <span i18n="@@didntReceiveCodePrompt">Didn't receive a code?</span>
            <div>
              <a (click)="resendCode()" class="resend-link" i18n="@@resendCodeLink">Resend</a>
              <span class="link-divider">|</span>
              <a (click)="cancel()" class="cancel-link" i18n="@@cancelLinkVerify">Cancel</a>
            </div>
          </div>

          <button mat-raised-button color="primary" type="submit" class="full-width verify-button" [disabled]="verifyCodeForm.invalid || isLoading">
            <span *ngIf="!isLoading" i18n="@@verifyButtonText">Verify</span>
            <mat-spinner *ngIf="isLoading" diameter="24" class="button-spinner"></mat-spinner>
          </button>
        </form>

        <!-- Optional: Dark mode toggle if needed -->
        <div class="dark-mode-toggle-container" *ngIf="iconsRegistered">
            <mat-slide-toggle [checked]="(themeService.isDarkMode$ | async)!" (change)="toggleDarkMode()" i18n="@@darkModeLabel">
              Dark Mode
            </mat-slide-toggle>
            <mat-icon svgIcon="moon" class="toggle-icon moon-icon"></mat-icon>
            <mat-icon svgIcon="sun" class="toggle-icon sun-icon"></mat-icon>
        </div>

      </div>
      <div class="panel-spacer-bottom"></div>
    </div>

    <div class="verify-code-right">
      <div class="carousel-container">
        <img *ngFor="let image of GALLERY_IMAGE_PATHS; let i = index"
             [src]="image"
             alt="Gallery image {{i + 1}}"
             i18n-alt="@@galleryImageAltText"
             class="carousel-image"
             [class.active]="i === currentImageIndex"
             loading="lazy">
      </div>
    </div>
  </div>
</div>

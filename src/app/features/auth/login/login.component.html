<div class="login-page-wrapper">
  <div class="login-container" [class.dark-theme]="isDarkMode" mat-typography>
    <div class="login-left">
      <img src="images/logo.svg" alt="TravelWise Logo" class="logo" i18n-alt="@@logoAltText">
      <div class="login-panel-spacer-top"></div> <div class="login-panel">
        <h2 i18n="@@loginTitle">Login</h2>
        <p class="subtitle" i18n="@@loginSubtitle">Login to access your travelwise account</p>

        <div *ngIf="errorMessage" class="error-message" role="alert">
          {{ errorMessage }}
        </div>

        <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label i18n="@@identifierLabel">Email or Username</mat-label>
            <input matInput formControlName="identifier" placeholder="your.email@example.com or username" i18n-placeholder="@@identifierPlaceholder" required autofocus>
            <button mat-icon-button matSuffix *ngIf="identifier.value" (click)="clearIdentifier()" type="button" aria-label="Clear email or username" i18n-aria-label="@@clearIdentifierAriaLabel">
              <mat-icon>close</mat-icon>
            </button>
            <mat-error *ngIf="identifier.hasError('required')" i18n="@@identifierRequiredError">
              Email or Username is required.
            </mat-error>
            <mat-error *ngIf="identifier.hasError('emailOrUsernameInvalid') && !identifier.hasError('required')" i18n="@@identifierInvalidError">
              Please enter a valid email or username.
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label i18n="@@passwordLabel">Password</mat-label>
            <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="password" placeholder="Enter your password" i18n-placeholder="@@passwordPlaceholder" required>
            <button mat-icon-button matSuffix (click)="togglePasswordVisibility()" type="button" [attr.aria-label]="hidePassword ? 'Show password' : 'Hide password'" [attr.i18n-aria-label]="hidePassword ? '@@showPasswordAriaLabel' : '@@hidePasswordAriaLabel'">
              <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            <mat-error *ngIf="password.hasError('required')" i18n="@@passwordRequiredError">
              Password is required.
            </mat-error>
          </mat-form-field>

          <div class="form-options">
            <mat-checkbox formControlName="rememberMe" i18n="@@rememberMeLabel">Remember me</mat-checkbox>
            <a href="#" class="forgot-password-link" i18n="@@forgotPasswordLink">Forgot Password?</a>
          </div>

          <button mat-raised-button color="primary" type="submit" class="full-width login-button" [disabled]="loginForm.invalid || isLoading">
            <span *ngIf="!isLoading" i18n="@@loginButtonText">Login</span>
            <mat-spinner *ngIf="isLoading" diameter="24" class="button-spinner"></mat-spinner>
          </button>
        </form>

        <div class="signup-link">
          <span i18n="@@dontHaveAccountPrompt">Don't have an account?</span>
          <a href="#" i18n="@@signUpLink">Sign up</a>
        </div>

        <div class="divider">
          <span i18n="@@orLoginWithDivider">Or login with</span>
        </div>

        <div class="social-buttons">
          <button mat-stroked-button class="social-button" aria-label="Login with Google" i18n-aria-label="@@loginWithGoogleAriaLabel">
            <mat-icon svgIcon="google"></mat-icon>
          </button>
          <button mat-stroked-button class="social-button" aria-label="Login with Facebook" i18n-aria-label="@@loginWithFacebookAriaLabel">
            <mat-icon svgIcon="facebook"></mat-icon>
          </button>
          <button mat-stroked-button class="social-button" aria-label="Login with Apple" i18n-aria-label="@@loginWithAppleAriaLabel">
            <mat-icon svgIcon="apple"></mat-icon>
          </button>
        </div>

        <div class="dark-mode-toggle-container">
          <mat-slide-toggle [checked]="(themeService.isDarkMode$ | async)!" (change)="toggleDarkMode()" i18n="@@darkModeLabel">
            Dark Mode
          </mat-slide-toggle>

          <mat-icon svgIcon="moon" class="toggle-icon moon-icon"></mat-icon>
          <mat-icon svgIcon="sun" class="toggle-icon sun-icon"></mat-icon>
        </div>

      </div>
      <div class="login-panel-spacer-bottom"></div> </div>

    <div class="login-right">
      <div class="carousel-container">
        <img *ngFor="let image of galleryImages; let i = index"
             [src]="image"
             alt="Gallery image {{i + 1}}"
             i18n-alt="@@galleryImageAltText"
             class="carousel-image"
             [class.active]="i === currentImageIndex"
             loading="lazy">
      </div>
    </div>
  </div>
</div>